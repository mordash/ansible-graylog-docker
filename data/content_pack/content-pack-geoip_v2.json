{
  "v": 1,
  "id": "1d437ac7-3082-48be-8bc2-313765ce9abd",
  "rev": 1,
  "name": "geoip_database",
  "summary": "geoip_database",
  "description": "geoip_database",
  "vendor": "lca",
  "url": "",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "57bd8323-75e1-4318-bafd-f6ed23be28f7",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "geoip_asn"
        },
        "title": {
          "@type": "string",
          "@value": "geoip_asn"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "maxmind_geoip"
          },
          "path": {
            "@type": "string",
            "@value": "/usr/share/graylog/data/geoip/GeoLite2-ASN.mmdb"
          },
          "database_type": {
            "@type": "string",
            "@value": "MAXMIND_ASN"
          },
          "check_interval": {
            "@type": "long",
            "@value": 1
          },
          "check_interval_unit": {
            "@type": "string",
            "@value": "MINUTES"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.0.9+f018089"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "35c24f76-fedf-4c68-a675-36b8da4e05df",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "446035c7-29a3-4e26-b587-4576f02a75d6"
        },
        "name": {
          "@type": "string",
          "@value": "geoip_asn"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "57bd8323-75e1-4318-bafd-f6ed23be28f7"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "geoip_asn"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.0.9+f018089"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "e001e3dc-daa3-4ab0-99ac-8ca0fb1c0e9a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GeoIP lookup: clientip"
        },
        "description": {
          "@type": "string",
          "@value": "geoip"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"GeoIP lookup: clientip\"\n\nwhen\n\n  has_field(\"client_ip\")\n\nthen\n\nlet geo = lookup(\"geoip_city\", to_string($message.client_ip));\n\nset_field(\"clientip_geo_location\", geo[\"coordinates\"]);\n\nset_field(\"clientip_geo_country\", geo[\"country\"].iso_code);\n\nset_field(\"clientip_geo_city\", geo[\"city\"].names.en);\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.0.9+f018089"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "446035c7-29a3-4e26-b587-4576f02a75d6",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "geoip"
        },
        "title": {
          "@type": "string",
          "@value": "geoip"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 1
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.0.9+f018089"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "85fa4912-6ae5-4bff-ae95-42ad4b7deff2",
      "data": {
        "title": {
          "@type": "string",
          "@value": "geoip_pipeline"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"geoip_pipeline\"\nstage 0 match either\nrule \"GeoIP lookup: clientip\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "000000000000000000000001"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.0.9+f018089"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "2591e7cd-cec3-459d-b4c7-4c3491a5169c",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "geoip-city"
        },
        "title": {
          "@type": "string",
          "@value": "geoip-city"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "maxmind_geoip"
          },
          "path": {
            "@type": "string",
            "@value": "/usr/share/graylog/data/geoip/GeoLite2-City.mmdb"
          },
          "database_type": {
            "@type": "string",
            "@value": "MAXMIND_CITY"
          },
          "check_interval": {
            "@type": "long",
            "@value": 1
          },
          "check_interval_unit": {
            "@type": "string",
            "@value": "MINUTES"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.0.9+f018089"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "d21aa34a-0745-4de3-82d1-68d518687080",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "446035c7-29a3-4e26-b587-4576f02a75d6"
        },
        "name": {
          "@type": "string",
          "@value": "geoip_city"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "2591e7cd-cec3-459d-b4c7-4c3491a5169c"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "geoip_city"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.0.9+f018089"
        }
      ]
    }
  ]
}